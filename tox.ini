[tox]
skipsdist = true
envlist =  py{39,310}, lint, typing
skip_missing_interpreters = True
cs_exclude_words = hass,unvalid

[gh-actions]
python =
  3.9: clean, py39, lint, typing
  3.10: clean, py310, lint, typing

[testenv]
passenv = TOXENV CI
whitelist_externals =
    true
setenv =
    LANG=en_US.UTF-8
    PYTHONPATH = {toxinidir}/manual_device_tracker-homeassistant
deps =
    -r{toxinidir}/requirements_test.txt
commands =
    true # TODO: Run tests later
    #pytest -n auto --log-level=debug -v --timeout=30 --durations=10 {posargs}

[testenv:lint]
ignore_errors = True
deps =
    {[testenv]deps}
commands =
    codespell -q 4 -L {[tox]cs_exclude_words} --skip="*.pyc,*.pyi,*~" custom_components
    flake8 custom_components
    black --fast --check .
    pydocstyle -v custom_components
    pylint custom_components/manual_device_tracker

[testenv:typing]
commands =
    mypy --ignore-missing-imports --follow-imports=skip custom_components
